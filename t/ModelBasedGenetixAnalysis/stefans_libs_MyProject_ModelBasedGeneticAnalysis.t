#! /usr/bin/perl
use strict;
use warnings;
use Test::More tests => 5;
BEGIN { use_ok 'stefans_libs::MyProject::ModelBasedGeneticAnalysis' }

my $model = stefans_libs_MyProject_ModelBasedGeneticAnalysis->new();
$model -> parse_from_string ( &file_STR() );

is_deeply ( scalar(@{$model->{'data'}}), 199 , "199 values");

is_deeply ( $model->Header_Position( 'diabetes_status'), 3, "pheotype");

$model-> calculate_all_models ( { 'SNP_count' => 5, 'max_subjects' => 200 , 'phenotype' => 'diabetes_status'} );

is_deeply ( scalar ( @{$model->{'models'}}), 16, "we got all models" );

foreach ( @{$model->{'models'}} ){
	print root::get_hashEntries_as_string ($_->Min(), 4, "The best protective model_sclice for model $_");
}
print root::get_hashEntries_as_string ($model->get_best_protective_model(), 4, "The best protective model ");

#print "\$exp = ".root->print_perl_var_def( $value ).";\n";











sub file_STR {
	return "sample_lable	genotype_number	gender	diabetes_status
6712	231312222312222122111	1	2
127	131313313311222112212	1	1
6942	101313311012322120213	2	2
11002	121202212213222221221	2	2
19455	211111112111222212111	1	2
19736	121212211210133021222	1	2
30614	131313312311133121211	2	2
30316	131212213311311322323	1	1
82554	132323323321222211322	1	1
20665	111111112111222112122	2	2
6043	211111111111222122223	2	2
82926	222222221221311313111	1	2
1387	121111112211133222233	1	2
29089	111111112111211103111	2	1
19666	311111112112311211111	1	1
86026	121212211213122112112	1	1
20006	132323321321211123132	1	2
30125	131111112311222112111	2	1
5887	111111111011222312211	2	1
2634	131312213311222112122	2	2
5345	121212211211211122322	1	1
17145	222222223221222012212	1	2
9333	121212211212311122122	1	2
21026	221212212212311123223	2	2
9736	211111113113122121211	2	1
17156	121212212211222101111	1	1
29030	211111113111222012112	2	1
17206	111111111111311122312	1	2
6531	122202222220311111211	1	2
30993	332323323321222112221	1	1
3185	111111112111222212112	1	1
3109	111111111111221122133	2	2
19485	121212211212133222211	2	2
742	131313312311222122321	1	1
82365	121212212212111121222	2	1
3936	232323322322111213112	2	1
5831	122222222222222112331	2	1
9834	111111112112222222212	2	2
11051	231313311311211111211	1	2
11647	121212211211311222313	2	2
30140	222222222221322112121	2	1
2203	221212212213222112112	1	2
11351	221212213211311111223	1	2
153	321212211211222123121	2	2
20834	122222222221122211212	2	2
2754	131313312312222112132	1	2
340	221212213211222221231	1	1
84275	131313312311122110222	2	1
11648	121212211210011121312	2	2
9208	221111112211133112312	2	2
20398	111111111111122312221	2	2
3844	131313311312222121122	2	1
86448	111111111111222112213	1	2
20503	232323322321222112122	1	2
825	122222222222222122113	2	1
3431	222222221221133013232	1	2
17458	231313312311222121312	2	2
9176	211111112112222221221	2	2
20253	231313312312133133212	1	2
5073	211111113112133112211	2	2
30744	221212211211222111211	2	2
20979	132322223322211113211	2	2
5880	232323320321222111212	2	2
2086	221212212211121213213	1	2
9126	111111111111133212213	2	2
30706	131313312312211212312	2	1
84332	111111111111222131222	2	1
82893	222222221222133222232	2	2
19483	131313312311222112211	2	2
2699	121212211212222312311	1	2
17647	121212212212222221111	1	2
17077	121212212212222113221	1	2
285	221212212211133221121	1	2
84077	111111113111311122122	1	1
2441	221212213212222223312	1	2
3574	121212213211222111121	1	2
3475	322222221221133123111	1	1
19914	122222223221222121212	1	1
9084	121212211211133121211	2	2
82410	121212212212133122121	1	2
3421	111111113111222111122	2	2
2194	221212212211322122321	2	2
19695	231313312311122311112	1	1
3092	122222222223133112212	2	1
17538	121212213212222321212	1	2
1135	121212211212133113121	1	2
13020	231313313312211112222	1	2
86509	121212211211222133332	1	1
5508	111111113112133132121	2	1
82186	311111111111311222212	2	1
31064	231313311311222021112	1	1
3836	121212212211311302212	2	1
9617	131313312311233211213	2	2
11681	221111112211311113212	1	2
486	231313311312111122222	1	2
20459	222222222221122131123	1	2
9908	121212212211222112313	1	2
17371	221212212211133122122	1	1
8	221212212211222112132	2	2
4213	121212212211111112211	1	1
30064	211111111111322131213	1	1
11912	211111111111133211111	2	1
29200	221212211211311122212	1	1
30292	221212212211222313111	1	1
2045	232323323321122202212	2	1
84266	211111112111322212311	1	1
3149	122222223021222211122	2	2
21006	222222222221311221232	1	2
17011	111111112112221111121	1	1
5188	221212213201222112322	2	1
5251	121212211211222112121	1	2
11651	121212211210211111122	1	1
21091	221212213212222212112	2	2
30228	311111112211311120322	2	1
30956	221212212212133211313	2	1
30586	132323322321222122123	2	1
19799	111111112113222131121	2	1
4353	222222223221222112222	1	1
82255	221212211212211123312	2	2
86304	321212212212133111232	1	1
21057	111111112111222012312	1	2
5610	211111112112311112111	2	1
30032	231313312311311222222	1	1
690	221202211213222111131	1	2
11957	222222222221222132112	2	1
30065	111111112112222112211	1	1
82517	221212211212222212212	1	2
85066	131313312311312022111	1	1
85047	122222221221133113112	2	1
2237	233333332302222132122	1	2
17236	221212212210311133213	2	2
17493	231313312312311222231	2	1
30375	121212212212222111212	1	1
84115	221212212211222122211	1	1
5780	111111112111133110213	1	1
2654	132323322321132112212	1	2
4209	222222220220211022322	1	2
20427	231313312312311113122	1	2
20983	111111112102133212313	2	2
444	121212213211311122321	2	2
82076	031313312312133111131	1	1
30324	131313311211211221322	1	1
82266	132323321323133211311	2	1
3627	211111112111222122211	1	1
30052	111111113111222212121	1	1
11383	111111112111222213211	2	2
86243	321212212211133113212	2	1
17451	321212212211222211111	1	2
19436	111111113111122122212	2	1
3200	221212210212311112211	2	1
20716	111111111112111212333	1	2
11903	211111112111222012211	1	1
2168	221212211312133101322	2	2
4137	111111111111222221232	1	2
30437	311111111111311132112	2	1
84142	221111111213222213231	1	1
13033	131313310311222212212	1	2
11691	221111111213233112233	2	1
20393	131313313311222113221	1	2
20511	221212212212211113222	1	2
30306	121212212211122032312	1	1
875	121212213212222121232	1	1
2350	221212212212311211311	1	2
11119	131212211311122021321	1	2
3467	233333332331133121112	1	2
6523	122222222223122123131	1	2
20911	222222221221311122111	1	2
82870	122222222222133112222	1	2
1580	111111113111311222112	1	1
29213	111111111111211113211	1	2
20946	233333332331222222121	1	2
17591	121212211211122103312	1	2
85364	121212211212211212212	2	2
29352	211111111112222112221	1	1
20059	111111011112311121123	2	2
4200	221212212211222223112	1	1
17003	221212213211133212222	2	2
678	122222222222322223121	1	1
6837	111111112111211112222	1	2
82819	322222221221222112123	1	1
3802	221212212212222122112	1	1
6709	121212211212233212212	1	2
5843	111111111112233211222	2	2
6097	111111112111222212121	2	2
20466	221212211213311212111	2	1
19148	111111112112211112212	1	2
20532	222222222221311132213	2	2
11404	111111112111222221212	2	2
30197	131312221311322212211	1	1
84132	121212212211222222122	2	1
31016	222222222221133111111	2	1
19452	121212212213322023212	1	2
927	221212212211211122121	2	2
5475	132322222321222222212	2	1
5855	211111110111222102222	1	1
82198	211111113113311121232	2	1
4272	331313313311133222112	1	2
83039	111111112111311211231	1	1
20050	121212211213222221211	2	2
"
}